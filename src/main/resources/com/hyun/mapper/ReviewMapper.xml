<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
  <mapper namespace="com.hyun.mapper.ReviewMapper">
   <insert id="review_insert" parameterType="com.hyun.domain.ReviewVO">
   
   INSERT 
   		INTO REVIEW_TBL(rew_num, mbsp_id, prod_num, rew_content, rew_score)
	VALUES
		(seq_review_tbl.NEXTVAL, #{mbsp_id}, #{prod_num}, #{rew_content}, #{rew_score})
   </insert>
   
   	<select id="list" parameterType="map" resultType="com.hyun.domain.ReviewVO">
	      <![CDATA[
      select 
          REW_NUM, MBSP_ID, PROD_NUM, REW_CONTENT, REW_SCORE, REW_REGDATE
      from 
          (
          select /*+INDEX_DESC(REVIEW_TBL PK_REVIEW_TBL) */	
              rownum rn, rew_num, mbsp_id, prod_num, rew_content, rew_score, rew_regdate
          from 
              REVIEW_TBL
          where 
          
             prod_num = #{prod_num}
             and    
              rownum <= #{cri.pageNum} * #{cri.amount}
          )
      where 
          rn > (#{cri.pageNum} -1) * #{cri.amount}
      ]]>
	</select>
	
	<select id="listCount" parameterType="Integer" resultType="int">
	SELECT
		count(*)
	FROM
		REVIEW_TBL
	WHERE
		prod_num = #{prod_num}
	
	</select>
	<delete id="delete" parameterType="Long">
	DELETE FROM
		REVIEW_TBL
	WHERE
		rew_num = #{rew_num}
	</delete>


  </mapper>
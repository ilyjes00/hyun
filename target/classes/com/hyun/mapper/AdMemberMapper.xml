<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
  <mapper namespace="com.hyun.mapper.AdMemberMapper">
  
         	<sql id="criteria">
	<trim prefix="(" suffix=") AND" prefixOverrides="OR">
		<foreach collection="typeArr" item="type">
			<trim prefix="OR">
				<choose>
					<when test="cri.type == 'C'.toString()">
						MBSP_ID like '%' || #{keyword} || '%'
					</when>
									
					<when test="cri.type == 'N'.toString()">
						MBSP_NAME like '%' || #{keyword} || '%'
					</when>
					
					<when test="cri.type == 'T'.toString()">
						MBSP_PHONE like '%' || #{keyword} || '%'
					</when>
				</choose>
			</trim>
		</foreach>
	</trim>
	</sql>
	
	
<select id="AdMemberList" resultType="com.hyun.domain.MemberVO" parameterType="com.hyun.dto.Criteria">
    <![CDATA[
	select 
		MBSP_ID, MBSP_NAME, MBSP_EMAIL, MBSP_PASSWORD, MBSP_ZIPCODE, MBSP_ADDR, MBSP_DEADDR, MBSP_PHONE, MBSP_POINT, MBSP_LASTLOGIN, MBSP_DATESUB, MBSP_UPDATEDATE
	from 
	(
		select /*+INDEX_DESC(MBSP_TBL PK_MBSP_ID) */
		
			rownum rn, MBSP_ID, MBSP_NAME, MBSP_EMAIL, MBSP_PASSWORD, MBSP_ZIPCODE, MBSP_ADDR, MBSP_DEADDR, MBSP_PHONE, MBSP_POINT, MBSP_LASTLOGIN, MBSP_DATESUB, MBSP_UPDATEDATE
		
		from 
			MBSP_TBL 
		where 
			]]>
		<include refid="criteria"></include>
		<![CDATA[ 
		rownum <= #{cri.pageNum} * #{cri.amount}
	)
	where rn > (#{cri.pageNum} -1) * #{cri.amount} 
	]]>
	</select>


	
		<select id="getTotalCount" resultType ="int">
		SELECT COUNT(*) FROM QA_TBL WHERE
		
		<include refid="criteria"></include>

	</select>
	
	
	   	   <select id="modify1" parameterType="String" resultType="com.hyun.domain.MemberVO">
   
   SELECT 
   		MBSP_ID, MBSP_NAME, MBSP_EMAIL, MBSP_PASSWORD, MBSP_ZIPCODE, MBSP_ADDR, MBSP_DEADDR, MBSP_PHONE, MBSP_POINT, MBSP_LASTLOGIN, MBSP_DATESUB, MBSP_UPDATEDATE
	FROM
		MBSP_TBL
	WHERE
		MBSP_ID = #{mbsp_id}
		
   </select>
   
   <update id="modify2" parameterType="map">
UPDATE 
	MBSP_TBL 
SET 
	MBSP_NAME = #{mbsp_name }, MBSP_EMAIL = #{mbsp_email }, MBSP_PASSWORD = #{mbsp_password }, MBSP_ZIPCODE = #{mbsp_zipcode }, MBSP_ADDR = #{mbsp_addr } , MBSP_DEADDR = #{mbsp_deaddr }, MBSP_PHONE = #{mbsp_phone }, MBSP_POINT = #{mbsp_point }
WHERE 
	MBSP_ID = #{mbsp_id }
</update>
    

  </mapper>